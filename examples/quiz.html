<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FPRO 20/21: TE01</title>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-giJF6kkoqNQ00vy+HMDP7azOuL0xtbfIcaT9wjKHr8RbDVddVHyTfAAsrekwKmP1" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/js/bootstrap.bundle.min.js" integrity="sha384-ygbV9kiqUc6oa4msXn9868pTtWMgiQaeYH7/t7LECLbyPA2x65Kgf80OJFdroafW" crossorigin="anonymous"></script>
    
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    
    <style>
        :root {
            --bs-success-shadow: #19875440;
            --bs-danger-shadow: #dc354540;
        }

        .container > div {
            display: flex;
            flex-direction: column;
        }

        .container > div > * {
            width: 100%;
        }

        @media (min-width: 992px) {
            :root {
                --form-width: 70%;
            }

            .container > div {
                flex-direction: row;
            }

            main {
                width: var(--form-width)!important;
            }

            aside {
                max-width: calc(100% - var(--form-width) - 4rem)!important;
            }

            aside > div {
                position: sticky;
                top: 25vh;
            }
        }

        .container label kbd {
            background-color: #212529ee;
        }

        aside nav {
            list-style-type: none;
            padding-left: 1em;
            margin: 1em 0;

            display: flex;
            flex-wrap: wrap;
            gap:0.5em;
        }

        aside nav a {
            text-decoration: none;

            display: flex;
            flex-direction: column;
            justify-content: center;

            width: 3.5ch;
            border-radius: 3px;
            outline: none;

            --bg-color: #212529;
            --text-color: #e8e8e8;
            background-color: var(--bg-color);
            color: var(--text-color);
            transition: background-color 0.25s ease-in-out, color 0.25s ease-in-out;
        }
        
        aside nav a:hover,
        aside nav a:focus {
            background-color: var(--text-color);
            color: var(--bg-color);
        }

        aside nav a span {
            width: 100%;
            text-align: center;
            border-radius: 0 0 3px 3px;
        }

        aside nav a span.nav-feedback-color {
            color: var(--text-color);

            display: flex;
            justify-content: center;
            align-items: center;

            transition: background-color 0.25s ease-in-out;
        }

        .bi {
            height: 1.5em;
        }

        /* Feedback for correct answers */
        fieldset.quiz-question-single-choice input.quiz-feedback-correct-answer:checked,
        fieldset.quiz-question-multiple-choice input.quiz-feedback-correct-answer:checked,
        fieldset.quiz-question-true-or-false input.quiz-feedback-correct-answer:checked,
        fieldset.quiz-question-short-answer input.quiz-feedback-correct-answer {
            box-shadow: 0 0 0 0.25rem var(--bs-success-shadow)!important;
            border-color: var(--bs-success)!important;
        }

        fieldset.quiz-question-single-choice input.quiz-feedback-correct-answer:checked,
        fieldset.quiz-question-multiple-choice input.quiz-feedback-correct-answer:checked,
        fieldset.quiz-question-true-or-false input.quiz-feedback-correct-answer:checked {
            background-color: var(--bs-success)!important;
        }

        /* Feedback for wrong answers */
        fieldset.quiz-question-single-choice input.quiz-feedback-wrong-answer:checked,
        fieldset.quiz-question-multiple-choice input.quiz-feedback-wrong-answer:checked,
        fieldset.quiz-question-true-or-false input.quiz-feedback-wrong-answer:checked,
        fieldset.quiz-question-short-answer input.quiz-feedback-wrong-answer {
            box-shadow: 0 0 0 0.25rem var(--bs-danger-shadow)!important;
            border-color: var(--bs-danger)!important;
        }

        fieldset.quiz-question-single-choice input.quiz-feedback-wrong-answer:checked,
        fieldset.quiz-question-multiple-choice input.quiz-feedback-wrong-answer:checked,
        fieldset.quiz-question-true-or-false input.quiz-feedback-wrong-answer:checked {
            background-color: var(--bs-danger)!important;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1 class="display-3 mt-4 mx-2">FPRO 20/21: TE01</h1>
        <div>
            <main class="mx-auto">
                <section>
                    <form>
                        <fieldset id="1" class="quiz-question-single-choice p-4 my-3 bg-light shadow">
                            <div class="prompt mb-4">
                                <p>Which algorithm do you choose to find a number in a sorted list of numbers?</p>
                            </div>
                            <div class="form-check my-2">
                                <input class="form-check-input" type="radio" name="1" id="1-0" value="0">
                                <label class="form-check-label" for="1-0"><span>Bubble sort</span></label>
                            </div>
                            <div class="form-check my-2">
                                <input class="form-check-input" type="radio" name="1" id="1-1" value="1">
                                <label class="form-check-label" for="1-1"><span>Binary search</span></label>
                            </div>
                            <div class="form-check my-2">
                                <input class="form-check-input" type="radio" name="1" id="1-2" value="2">
                                <label class="form-check-label" for="1-2"><span>Linear search</span></label>
                            </div>
                            <div class="form-check my-2">
                                <input class="form-check-input" type="radio" name="1" id="1-3" value="3">
                                <label class="form-check-label" for="1-3"><span>Merge sorted lists</span></label>
                            </div>
                            <button class="btn btn-outline-danger mt-3 px-5 quiz-reset-fieldset">Clear answer</button>
                        </fieldset>
                        <fieldset id="2" class="quiz-question-single-choice p-4 my-3 bg-light shadow">
                            <div class="prompt mb-4">
                                <p>What is the output of the following statements?</p>
                                <pre class="fw-bold"><code>s = "hello world!"<br>s = s.split()<br>s = ''.join(s)<br>print(s)</code></pre>
                            </div>
                            <div class="form-check my-2">
                                <input class="form-check-input" type="radio" name="2" id="2-0" value="0">
                                <label class="form-check-label" for="2-0"><kbd>hello world!</kbd></label>
                            </div>
                            <div class="form-check my-2">
                                <input class="form-check-input" type="radio" name="2" id="2-1" value="1">
                                <label class="form-check-label" for="2-1"><kbd>['hello', 'world!']</kbd></label>
                            </div>
                            <div class="form-check my-2">
                                <input class="form-check-input" type="radio" name="2" id="2-2" value="2">
                                <label class="form-check-label" for="2-2"><kbd>['hello world!']</kbd></label>
                            </div>
                            <div class="form-check my-2">
                                <input class="form-check-input" type="radio" name="2" id="2-3" value="3">
                                <label class="form-check-label" for="2-3"><kbd>helloworld!</kbd></label>
                            </div>
                            <button class="btn btn-outline-danger mt-3 px-5 quiz-reset-fieldset">Clear answer</button>
                        </fieldset>
                        <fieldset id="3" class="quiz-question-single-choice p-4 my-3 bg-light shadow">
                            <div class="prompt mb-4">
                                <p>What is the output of the following statements?</p>
                                <pre class="fw-bold"><code>l = list(enumerate(range(0, 8, 2)))<br>print(l)</code></pre>
                            </div>
                            <div class="form-check my-2">
                                <input class="form-check-input" type="radio" name="3" id="3-0" value="0">
                                <label class="form-check-label" for="3-0"><kbd>[(0, 0), (2, 2), (4, 4), (6, 6)]</kbd></label>
                            </div>
                            <div class="form-check my-2">
                                <input class="form-check-input" type="radio" name="3" id="3-1" value="1">
                                <label class="form-check-label" for="3-1"><kbd>[(0, 0), (1, 2), (2, 4), (3, 6), (4, 8)]</kbd></label>
                            </div>
                            <div class="form-check my-2">
                                <input class="form-check-input" type="radio" name="3" id="3-2" value="2">
                                <label class="form-check-label" for="3-2"><kbd>[(0, 0), (2, 2), (4, 4), (6, 6), (8, 8)]</kbd></label>
                            </div>
                            <div class="form-check my-2">
                                <input class="form-check-input" type="radio" name="3" id="3-3" value="3">
                                <label class="form-check-label" for="3-3"><kbd>[(0, 0), (1, 2), (2, 4), (3, 6)]</kbd></label>
                            </div>
                            <button class="btn btn-outline-danger mt-3 px-5 quiz-reset-fieldset">Clear answer</button>
                        </fieldset>
                        <fieldset id="4" class="quiz-question-single-choice p-4 my-3 bg-light shadow">
                            <div class="prompt mb-4">
                                <p>What is the output of the following statements?</p>
                                <pre class="fw-bold"><code>def foo():<br>    while True:<br>        yield 1<br>        yield 2<br>for _ in range(2): print(next(foo()))</code></pre>
                            </div>
                            <div class="form-check my-2">
                                <input class="form-check-input" type="radio" name="4" id="4-0" value="0">
                                <label class="form-check-label" for="4-0"><kbd>&lt;generator object f at 0x7f08d906a4c0&gt;</kbd></label>
                            </div>
                            <div class="form-check my-2">
                                <input class="form-check-input" type="radio" name="4" id="4-1" value="1">
                                <label class="form-check-label" for="4-1"><kbd>1\n1</kbd></label>
                            </div>
                            <div class="form-check my-2">
                                <input class="form-check-input" type="radio" name="4" id="4-2" value="2">
                                <label class="form-check-label" for="4-2"><span>None, there's a <em>runtime</em> error</span></label>
                            </div>
                            <div class="form-check my-2">
                                <input class="form-check-input" type="radio" name="4" id="4-3" value="3">
                                <label class="form-check-label" for="4-3"><kbd>1\n2</kbd></label>
                            </div>
                            <button class="btn btn-outline-danger mt-3 px-5 quiz-reset-fieldset">Clear answer</button>
                        </fieldset>
                        <fieldset id="5" class="quiz-question-short-answer p-4 my-3 bg-light shadow">
                            <div class="prompt mb-4">
                                <p>What is the output of the following statements?</p>
                                <pre class="fw-bold"><code>def foo():<br>    while True:<br>        yield 1<br>        yield 2<br>print(next(foo()) + next(foo()))</code></pre>
                            </div>
                            <div class="my-2">
                                <input class="form-control" type="text" name="5" id="5-0" autocomplete="off">
                            </div>
                            <button class="btn btn-outline-danger mt-3 px-5 quiz-reset-fieldset">Clear answer</button>
                        </fieldset>
                        <fieldset id="6" class="quiz-question-true-or-false p-4 my-3 bg-light shadow">
                            <div class="prompt mb-4">
                                <p>Consider the following statement: <em>"The output of the following statements is 3"</em>.</p>
                                <pre class="fw-bold"><code>def bar():<br>    yield 1 + 2<br>bar()</code></pre>
                                <p>Is the statement <em>true</em> or <em>false</em>?</p>
                            </div>
                            <div class="form-check my-2">
                                <input class="form-check-input" type="radio" name="6" id="6-0" value="true">
                                <label class="form-check-label" for="6-0"><span>True</span></label>
                            </div>
                            <div class="form-check my-2">
                                <input class="form-check-input" type="radio" name="6" id="6-1" value="false">
                                <label class="form-check-label" for="6-1"><span>False</span></label>
                            </div>
                            <button class="btn btn-outline-danger mt-3 px-5 quiz-reset-fieldset">Clear answer</button>
                        </fieldset>
                        <fieldset id="7" class="quiz-question-multiple-choice p-4 my-3 bg-light shadow">
                            <div class="prompt mb-4">
                                <p>Which of the following options <em>could</em> be an output of the following statements?</p>
                                <pre class="fw-bold"><code>import random<br>def foobar():<br>    return random.randrange(0, 2)<br>print(foobar())</code></pre>
                            </div>
                            <div class="form-check my-2">
                                <input class="form-check-input" type="checkbox" name="7" id="7-0" value="0">
                                <label class="form-check-label" for="7-0"><kbd>0</kbd></label>
                            </div>
                            <div class="form-check my-2">
                                <input class="form-check-input" type="checkbox" name="7" id="7-1" value="1">
                                <label class="form-check-label" for="7-1"><kbd>1</kbd></label>
                            </div>
                            <div class="form-check my-2">
                                <input class="form-check-input" type="checkbox" name="7" id="7-2" value="2">
                                <label class="form-check-label" for="7-2"><span>There is no output</label>
                            </div>
                            <div class="form-check my-2">
                                <input class="form-check-input" type="checkbox" name="7" id="7-3" value="3">
                                <label class="form-check-label" for="7-3"><kbd>2</kbd></label>
                            </div>
                            <div class="form-check my-2">
                                <input class="form-check-input" type="checkbox" name="7" id="7-4" value="3">
                                <label class="form-check-label" for="7-4"><span><kbd>None</kbd></label>
                            </div>
                            <button class="btn btn-outline-danger mt-3 px-5 quiz-reset-fieldset">Clear answer</button>
                        </fieldset>
                        <div class="row my-5 mx-auto">
                            <input id="check" class="btn btn-success col m-1" type="submit" value="Check answers">
                            <button id="fill" class="btn btn-outline-primary col m-1">Show correct answers</button>
                            <button id="clear" class="btn btn-outline-danger col m-1">Clear answers</button>
                        </div>
                    </form>
                </section>
            </main>
            <aside class="mx-auto">
                <div class="p-4 my-3 bg-light shadow">
                    <h5>FPRO 20/21: TE01</h5>
                    <nav>
                        <a id="nav-1" href="#1"><span>1</span><span class="nav-feedback-color"></span></a>
                        <a id="nav-2" href="#2"><span>2</span><span class="nav-feedback-color"></span></a>
                        <a id="nav-3" href="#3"><span>3</span><span class="nav-feedback-color"></span></a>
                        <a id="nav-4" href="#4"><span>4</span><span class="nav-feedback-color"></span></a>
                        <a id="nav-5" href="#5"><span>5</span><span class="nav-feedback-color"></span></a>
                        <a id="nav-6" href="#6"><span>6</span><span class="nav-feedback-color"></span></a>
                        <a id="nav-7" href="#7"><span>6</span><span class="nav-feedback-color"></span></a>
                    </nav>
                </div>
            </aside>
        </div>
    </div>
    <script>
        const questions = [
            {
                "answers": [ {}, { "correct": true }, {}, {} ]
            },
            {
                "answers": [ {}, {}, {}, { "correct": true } ]
            },
            {
                "answers": [ {}, {}, {}, { "correct": true } ]
            },
            {
                "answers": [ {}, { "correct": true }, {}, {} ]
            },
            {
                "correct": "2"
            },
            {
                "correct": false
            },
            {
                "answers": [ { "correct": true }, { "correct": true }, {}, {}, {} ]
            }
        ];

        // --------------------------------------------------------------------

        function getFieldset(element) {
            if (element.nodeName === 'FIELDSET')
                return element;
            else if (element.parentElement)
                return getFieldset(element.parentElement);
            
            return null;
        }

        function getNavFeedbackElementFromElement(element) {
            const fieldset = getFieldset(element);
            if (!fieldset)
                return null;

            const id = `nav-${fieldset.id}`;
            return document.querySelector(`aside nav a#${id} span.nav-feedback-color`);
        }

        function getQuestionFromElement(element) {
            const fieldset = getFieldset(element);
            if (!fieldset)
                return null;

            const index = parseInt(fieldset.id) - 1;
            return questions[index];
        }

        function clearFeedback(element) {
            const fieldset = getFieldset(element);
            if (!fieldset)
                return element.querySelectorAll('fieldset').forEach(clearFeedback);

            fieldset.querySelectorAll('input')
                .forEach(input => input.classList.remove('quiz-feedback-correct-answer', 'quiz-feedback-wrong-answer')); 
        
            const feedbackElement = getNavFeedbackElementFromElement(fieldset);
            updateNavFeedback(fieldset);
        }

        function updateNavFeedback(element) {
            const fieldset = getFieldset(element);
            if (!fieldset)
                return document.querySelectorAll('fieldset').forEach(updateNavFeedback);

            const feedbackElement = getNavFeedbackElementFromElement(fieldset);
            feedbackElement.classList.remove('bg-success', 'bg-danger', 'bg-primary', 'bg-warning');

            if (fieldset.querySelector('input')) {
                const correct = fieldset.querySelector('input.quiz-feedback-correct-answer');
                const wrong = fieldset.querySelector('input.quiz-feedback-wrong-answer');

                if (wrong) {
                    feedbackElement.classList.add('bg-danger');
                    feedbackElement.innerHTML = '<svg xmlns="http://www.w3.org/2000/svg" fill="currentColor" class="bi bi-x" viewBox="0 0 16 16"><path d="M4.646 4.646a.5.5 0 0 1 .708 0L8 7.293l2.646-2.647a.5.5 0 0 1 .708.708L8.707 8l2.647 2.646a.5.5 0 0 1-.708.708L8 8.707l-2.646 2.647a.5.5 0 0 1-.708-.708L7.293 8 4.646 5.354a.5.5 0 0 1 0-.708z"/></svg>';
                } else if (correct) {
                    feedbackElement.classList.add('bg-success');
                    feedbackElement.innerHTML = '<svg xmlns="http://www.w3.org/2000/svg" fill="currentColor" class="bi bi-check" viewBox="0 0 16 16"><path d="M10.97 4.97a.75.75 0 0 1 1.07 1.05l-3.99 4.99a.75.75 0 0 1-1.08.02L4.324 8.384a.75.75 0 1 1 1.06-1.06l2.094 2.093 3.473-4.425a.267.267 0 0 1 .02-.022z"/></svg>';
                } else {
                    feedbackElement.classList.add('bg-warning');
                    feedbackElement.innerHTML = '<svg xmlns="http://www.w3.org/2000/svg" fill="currentColor" class="bi bi-question" viewBox="0 0 16 16"><path d="M5.255 5.786a.237.237 0 0 0 .241.247h.825c.138 0 .248-.113.266-.25.09-.656.54-1.134 1.342-1.134.686 0 1.314.343 1.314 1.168 0 .635-.374.927-.965 1.371-.673.489-1.206 1.06-1.168 1.987l.003.217a.25.25 0 0 0 .25.246h.811a.25.25 0 0 0 .25-.25v-.105c0-.718.273-.927 1.01-1.486.609-.463 1.244-.977 1.244-2.056 0-1.511-1.276-2.241-2.673-2.241-1.267 0-2.655.59-2.75 2.286zm1.557 5.763c0 .533.425.927 1.01.927.609 0 1.028-.394 1.028-.927 0-.552-.42-.94-1.029-.94-.584 0-1.009.388-1.009.94z"/></svg>';
                }
            } else {
                // This is a fieldset that has no input elements
                // Therefore, we should only mark this with an exclamation mark and appropriate background colors
                feedbackElement.classList.add('bg-primary');
                feedbackElement.innerHTML = '<svg xmlns="http://www.w3.org/2000/svg" fill="currentColor" class="bi bi-exclamation" viewBox="0 0 16 16"><path d="M7.002 11a1 1 0 1 1 2 0 1 1 0 0 1-2 0zM7.1 4.995a.905.905 0 1 1 1.8 0l-.35 3.507a.553.553 0 0 1-1.1 0L7.1 4.995z"/></svg>';
            }
        }
        
        function resetAnswers(element) {
            const fieldset = getFieldset(element);
            if (!fieldset)
                return element.querySelectorAll('fieldset').forEach(resetAnswers);

            clearFeedback(fieldset);
            fieldset.querySelectorAll('input').forEach(input => {
                input.value = input.defaultValue;
                input.checked = input.defaultChecked;
            });

        }

        document.querySelectorAll(".quiz-reset-fieldset").forEach(fieldsetClearButton => {
            fieldsetClearButton.addEventListener('click', event => {
                event.preventDefault();

                const fieldset = getFieldset(fieldsetClearButton);
                if (fieldset) 
                    resetAnswers(fieldset);
            });
        });

        document.querySelectorAll('input:not([type="reset"]):not([type="submit"])')
            .forEach(input => input.addEventListener('input', () => clearFeedback(input)));
        
        
        const checkButton = document.querySelector('#check');
        checkButton.addEventListener('click', event => {
            event.preventDefault();

            const form = document.querySelector('form');
            clearFeedback(form);

            // Provide feedback on single choice questions
            form.querySelectorAll('fieldset.quiz-question-single-choice').forEach(fieldset => {
                const question = getQuestionFromElement(fieldset);
                const input = fieldset.querySelector('input:checked');
                if (!input) // In case the user hasn't answered, we do not want to provide feedback
                    return;

                const index = parseInt(input.value);
                const isAnswerCorrect = question.answers[index].correct || false;
                
                fieldset.querySelectorAll('input').forEach(sibling =>
                    sibling.classList.add(isAnswerCorrect ? 'quiz-feedback-correct-answer' : 'quiz-feedback-wrong-answer'));
            });

            // Provide feedback on multiple choice questions
            form.querySelectorAll('fieldset.quiz-question-multiple-choice').forEach(fieldset => {
                const question = getQuestionFromElement(fieldset);

                // If there isn't at least one element selected,
                // we shouldn't provide feedback for that question
                if(!fieldset.querySelector('input:checked'))
                    return;
                
                fieldset.querySelectorAll('input').forEach(input => {
                    const index = parseInt(input.value);
                    const correctAnswer = question.answers[index].correct || false;

                    const isAnswerCorrect = input.checked === correctAnswer;
                    input.classList.add(isAnswerCorrect ? 'quiz-feedback-correct-answer' : 'quiz-feedback-wrong-answer');
                });
            });

            // Provide feedback on true or false questions
            form.querySelectorAll('fieldset.quiz-question-true-or-false').forEach(fieldset => {
                const question = getQuestionFromElement(fieldset);
                const input = fieldset.querySelector('input:checked');
                if (!input) // In case the user hasn't answered, we do not want to provide feedback
                    return;

                const option = input.value === 'true';
                const isAnswerCorrect = (option === question.correct) === input.checked;

                fieldset.querySelectorAll('input').forEach(sibling => {
                    sibling.classList.add(isAnswerCorrect ? 'quiz-feedback-correct-answer' : 'quiz-feedback-wrong-answer');
                });
            });

            // Provide feedback for short answer questions
            form.querySelectorAll('fieldset.quiz-question-short-answer').forEach(fieldset => {
                const question = getQuestionFromElement(fieldset);
                const correctAnswers =
                    typeof question.correct === 'string' ? [ question.correct] : question.correct;

                const input = fieldset.querySelector('input');
                if (!input.value)
                    return;

                const isAnswerCorrect = correctAnswers.indexOf(input.value) !== -1;
                input.classList.add(isAnswerCorrect ? 'quiz-feedback-correct-answer' : 'quiz-feedback-wrong-answer');
            });

            updateNavFeedback(form);
        });
        
        const fillButton = document.querySelector('#fill');
        fillButton.addEventListener('click', event => {
            event.preventDefault();

            const form = document.querySelector('form');
            resetAnswers(form);

            // Fill single and multiple choice questions
            form.querySelectorAll('fieldset.quiz-question-single-choice, fieldset.quiz-question-multiple-choice').forEach(fieldset => {
                const question = getQuestionFromElement(fieldset);
                fieldset.querySelectorAll('input').forEach(input => {
                    const index = parseInt(input.value);
                    if (question.answers[index].correct)
                        input.checked = true;
                });
            });

            // Fill true or false questions
            form.querySelectorAll('fieldset.quiz-question-true-or-false').forEach(fieldset => {
                const question = getQuestionFromElement(fieldset);
                const input = fieldset.querySelector(`input[value="${question.correct}"]`);
                
                input.checked = true;
            });

            // Fill short answer questions
            form.querySelectorAll('fieldset.quiz-question-short-answer').forEach(fieldset => {
                const question = getQuestionFromElement(fieldset);
                const correctAnswers =
                    typeof question.correct === 'string' ? [ question.correct ] : question.correct;

                const input = fieldset.querySelector('input');
                input.value = correctAnswers[0];    
            });
        });
        
        const clearButton = document.querySelector('#clear');
        clearButton.addEventListener('click', event => {
            event.preventDefault();

            const form = document.querySelector('form');
            resetAnswers(form);
        });

        updateNavFeedback(document);
    </script>
</body>
</html>
