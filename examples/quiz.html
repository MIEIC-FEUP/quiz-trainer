<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FPRO 20/21: TE01</title>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-giJF6kkoqNQ00vy+HMDP7azOuL0xtbfIcaT9wjKHr8RbDVddVHyTfAAsrekwKmP1" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/js/bootstrap.bundle.min.js" integrity="sha384-ygbV9kiqUc6oa4msXn9868pTtWMgiQaeYH7/t7LECLbyPA2x65Kgf80OJFdroafW" crossorigin="anonymous"></script>
    
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    
    <style>
        :root {
            --bs-success-shadow: #19875440;
            --bs-danger-shadow: #dc354540;
        }

        .container > div {
            display: flex;
            flex-direction: column;
        }

        .container > div > * {
            width: 100%;
        }

        @media (min-width: 992px) {
            :root {
                --form-width: 70%;
            }

            .container > div {
                flex-direction: row;
            }

            main {
                width: var(--form-width)!important;
            }

            aside {
                width: calc(100% - var(--form-width) - 3rem)!important;
            }

            aside > div {
                position: sticky;
                top: 25vh;
            }
        }

        .container label kbd {
            background-color: #212529ee;
        }

        /* Feedback for correct answers */
        fieldset.quiz-question-single-choice input.quiz-feedback-correct-answer:checked,
        fieldset.quiz-question-multiple-choice input.quiz-feedback-correct-answer:checked,
        fieldset.quiz-question-true-or-false input.quiz-feedback-correct-answer:checked,
        fieldset.quiz-question-short-answer input.quiz-feedback-correct-answer {
            box-shadow: 0 0 0 0.25rem var(--bs-success-shadow)!important;
            border-color: var(--bs-success)!important;
        }

        fieldset.quiz-question-single-choice input.quiz-feedback-correct-answer:checked,
        fieldset.quiz-question-multiple-choice input.quiz-feedback-correct-answer:checked,
        fieldset.quiz-question-true-or-false input.quiz-feedback-correct-answer:checked {
            background-color: var(--bs-success)!important;
        }

        /* Feedback for wrong answers */
        fieldset.quiz-question-single-choice input.quiz-feedback-wrong-answer:checked,
        fieldset.quiz-question-multiple-choice input.quiz-feedback-wrong-answer,
        fieldset.quiz-question-true-or-false input.quiz-feedback-wrong-answer:checked,
        fieldset.quiz-question-short-answer input.quiz-feedback-wrong-answer {
            box-shadow: 0 0 0 0.25rem var(--bs-danger-shadow)!important;
            border-color: var(--bs-danger)!important;
        }

        fieldset.quiz-question-single-choice input.quiz-feedback-wrong-answer:checked,
        fieldset.quiz-question-multiple-choice input.quiz-feedback-wrong-answer:checked,
        fieldset.quiz-question-true-or-false input.quiz-feedback-wrong-answer:checked {
            background-color: var(--bs-danger)!important;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1 class="display-3 mt-4 mx-2">FPRO 20/21: TE01</h1>
        <div>
            <main class="mx-auto">
                <section>
                    <form>
                        <fieldset id="0" class="quiz-question-single-choice p-4 my-3 bg-light shadow">
                            <div class="prompt mb-4">
                                <p>Which algorithm do you choose to find a number in a sorted list of numbers?</p>
                            </div>
                            <div class="form-check my-2">
                                <input class="form-check-input" type="radio" name="0" id="0-0" value="0">
                                <label class="form-check-label" for="0-0"><span>Bubble sort</span></label>
                            </div>
                            <div class="form-check my-2">
                                <input class="form-check-input" type="radio" name="0" id="0-1" value="1">
                                <label class="form-check-label" for="0-1"><span>Binary search</span></label>
                            </div>
                            <div class="form-check my-2">
                                <input class="form-check-input" type="radio" name="0" id="0-2" value="2">
                                <label class="form-check-label" for="0-2"><span>Linear search</span></label>
                            </div>
                            <div class="form-check my-2">
                                <input class="form-check-input" type="radio" name="0" id="0-3" value="3">
                                <label class="form-check-label" for="0-3"><span>Merge sorted lists</span></label>
                            </div>
                            <button class="btn btn-outline-danger mt-3 px-5 quiz-reset-fieldset">Clear answer</button>
                        </fieldset>
                        <fieldset id="1" class="quiz-question-single-choice p-4 my-3 bg-light shadow">
                            <div class="prompt mb-4">
                                <p>What is the output of the following statements?</p>
                                <pre class="fw-bold"><code>s = "hello world!"<br>s = s.split()<br>s = ''.join(s)<br>print(s)</code></pre>
                            </div>
                            <div class="form-check my-2">
                                <input class="form-check-input" type="radio" name="1" id="1-0" value="0">
                                <label class="form-check-label" for="1-0"><kbd>hello world!</kbd></label>
                            </div>
                            <div class="form-check my-2">
                                <input class="form-check-input" type="radio" name="1" id="1-1" value="1">
                                <label class="form-check-label" for="1-1"><kbd>['hello', 'world!']</kbd></label>
                            </div>
                            <div class="form-check my-2">
                                <input class="form-check-input" type="radio" name="1" id="1-2" value="2">
                                <label class="form-check-label" for="1-2"><kbd>['hello world!']</kbd></label>
                            </div>
                            <div class="form-check my-2">
                                <input class="form-check-input" type="radio" name="1" id="1-3" value="3">
                                <label class="form-check-label" for="1-3"><kbd>helloworld!</kbd></label>
                            </div>
                            <button class="btn btn-outline-danger mt-3 px-5 quiz-reset-fieldset">Clear answer</button>
                        </fieldset>
                        <fieldset id="2" class="quiz-question-single-choice p-4 my-3 bg-light shadow">
                            <div class="prompt mb-4">
                                <p>What is the output of the following statements?</p>
                                <pre class="fw-bold"><code>l = list(enumerate(range(0, 8, 2)))<br>print(l)</code></pre>
                            </div>
                            <div class="form-check my-2">
                                <input class="form-check-input" type="radio" name="2" id="2-0" value="0">
                                <label class="form-check-label" for="2-0"><kbd>[(0, 0), (2, 2), (4, 4), (6, 6)]</kbd></label>
                            </div>
                            <div class="form-check my-2">
                                <input class="form-check-input" type="radio" name="2" id="2-1" value="1">
                                <label class="form-check-label" for="2-1"><kbd>[(0, 0), (1, 2), (2, 4), (3, 6), (4, 8)]</kbd></label>
                            </div>
                            <div class="form-check my-2">
                                <input class="form-check-input" type="radio" name="2" id="2-2" value="2">
                                <label class="form-check-label" for="2-2"><kbd>[(0, 0), (2, 2), (4, 4), (6, 6), (8, 8)]</kbd></label>
                            </div>
                            <div class="form-check my-2">
                                <input class="form-check-input" type="radio" name="2" id="2-3" value="3">
                                <label class="form-check-label" for="2-3"><kbd>[(0, 0), (1, 2), (2, 4), (3, 6)]</kbd></label>
                            </div>
                            <button class="btn btn-outline-danger mt-3 px-5 quiz-reset-fieldset">Clear answer</button>
                        </fieldset>
                        <fieldset id="3" class="quiz-question-multiple-choice p-4 my-3 bg-light shadow">
                            <div class="prompt mb-4">
                                <p>What is the output of the following statements?</p>
                                <pre class="fw-bold"><code>def foo():<br>    while True:<br>        yield 1<br>        yield 2<br>for _ in range(2): print(next(foo()))</code></pre>
                            </div>
                            <div class="form-check my-2">
                                <input class="form-check-input" type="checkbox" name="3" id="3-0" value="0">
                                <label class="form-check-label" for="3-0"><kbd>&lt;generator object f at 0x7f08d906a4c0&gt;</kbd></label>
                            </div>
                            <div class="form-check my-2">
                                <input class="form-check-input" type="checkbox" name="3" id="3-1" value="1">
                                <label class="form-check-label" for="3-1"><kbd>1\n1</kbd></label>
                            </div>
                            <div class="form-check my-2">
                                <input class="form-check-input" type="checkbox" name="3" id="3-2" value="2">
                                <label class="form-check-label" for="3-2"><span>None, there's a <em>runtime</em> error</span></label>
                            </div>
                            <div class="form-check my-2">
                                <input class="form-check-input" type="checkbox" name="3" id="3-3" value="3">
                                <label class="form-check-label" for="3-3"><kbd>1\n2</kbd></label>
                            </div>
                            <button class="btn btn-outline-danger mt-3 px-5 quiz-reset-fieldset">Clear answer</button>
                        </fieldset>
                        <fieldset id="4" class="quiz-question-short-answer p-4 my-3 bg-light shadow">
                            <div class="prompt mb-4">
                                <p>What is the output of the following statements?</p>
                                <pre class="fw-bold"><code>def foo():<br>    while True:<br>        yield 1<br>        yield 2<br>for _ in range(2): print(next(foo()))</code></pre>
                            </div>
                            <div class="my-2">
                                <input class="form-control" type="text" name="4" id="4-0" autocomplete="off">
                            </div>
                            <button class="btn btn-outline-danger mt-3 px-5 quiz-reset-fieldset">Clear answer</button>
                        </fieldset>
                        <fieldset id="5" class="quiz-question-true-or-false p-4 my-3 bg-light shadow">
                            <div class="prompt mb-4">
                                <p>What is the output of the following statements?</p>
                                <pre class="fw-bold"><code>def foo():<br>    while True:<br>        yield 1<br>        yield 2<br>for _ in range(2): print(next(foo()))</code></pre>
                            </div>
                            <div class="form-check my-2">
                                <input class="form-check-input" type="radio" name="5" id="5-0" value="true">
                                <label class="form-check-label" for="5-0"><span>True</span></label>
                            </div>
                            <div class="form-check my-2">
                                <input class="form-check-input" type="radio" name="5" id="5-1" value="false">
                                <label class="form-check-label" for="5-1"><span>False</span></label>
                            </div>
                            <button class="btn btn-outline-danger mt-3 px-5 quiz-reset-fieldset">Clear answer</button>
                        </fieldset>
                        <div class="row my-5 mx-auto">
                            <input id="check" class="btn btn-success col m-1" type="submit" value="Check answers">
                            <button id="fill" class="btn btn-outline-primary col m-1">Show correct answers</button>
                            <button id="clear" class="btn btn-outline-danger col m-1">Clear answers</button>
                        </div>
                    </form>
                </section>
            </main>
            <aside class="mx-auto">
                <div class="p-4 my-3 bg-light bg-gradient shadow">
                    <p>Lorem ipsum dolor sit, amet consectetur adipisicing elit. Debitis temporibus placeat corporis? Laudantium quam quis magnam tempore quod accusantium suscipit, aspernatur sunt in aperiam animi magni commodi? Magnam, vitae fuga.</p>
                </div>
            </aside>
        </div>
    </div>
    <script>
        const questions = [
            {
                "questionType": "single-choice",
                "answers": [ {}, { "correct": true }, {}, {} ]
            },
            {
                "questionType": "single-choice",
                "answers": [ {}, {}, {}, { "correct": true } ]
            },
            {
                "questionType": "single-choice",
                "answers": [ {}, {}, {}, { "correct": true } ]
            },
            {
                "questionType": "single-choice",
                "answers": [ {}, { "correct": true }, {}, { "correct": true } ]
            },
            {
                "questionType": "short-answer",
                "correct": "hi"
            },
            {
                "questionType": "true-or-false",
                "correct": true
            }
        ];

        // --------------------------------------------------------------------

        function getFieldset(element) {
            if (element.nodeName === 'FIELDSET')
                return element;
            else if (element.parentElement)
                return getFieldset(element.parentElement);
            
            return null;
        }

        function getQuestionFromElement(element) {
            const fieldset = getFieldset(element);
            if (!fieldset)
                return null;

            const index = parseInt(fieldset.id);
            return questions[index];
        }

        function clearFeedback(element) {
            const fieldset = getFieldset(element);
            if (!fieldset)
                return element.querySelectorAll('fieldset').forEach(clearFeedback);

            fieldset.querySelectorAll('input')
                .forEach(input => input.classList.remove('quiz-feedback-correct-answer', 'quiz-feedback-wrong-answer')); 
        }
        
        function resetAnswers(element) {
            const fieldset = getFieldset(element);
            if (!fieldset)
                return element.querySelectorAll('fieldset').forEach(resetAnswers);

            clearFeedback(fieldset);
            fieldset.querySelectorAll('input').forEach(input => {
                input.value = input.defaultValue;
                input.checked = input.defaultChecked;
            });

        }

        document.querySelectorAll(".quiz-reset-fieldset").forEach(fieldsetClearButton => {
            fieldsetClearButton.addEventListener('click', event => {
                event.preventDefault();

                const fieldset = getFieldset(fieldsetClearButton);
                if (fieldset) 
                    resetAnswers(fieldset);
            });
        });

        document.querySelectorAll('input:not([type="reset"]):not([type="submit"])')
            .forEach(input => input.addEventListener('input', () => clearFeedback(input)));
        
        
        const checkButton = document.querySelector('#check');
        checkButton.addEventListener('click', event => {
            event.preventDefault();

            const form = document.querySelector('form');
            clearFeedback(form);

            // Provide feedback on single choice questions
            form.querySelectorAll('fieldset.quiz-question-single-choice').forEach(fieldset => {
                const question = getQuestionFromElement(fieldset);
                const input = fieldset.querySelector('input:checked');
                if (!input) // In case the user hasn't answered, we do not want to provide feedback
                    return;

                const index = parseInt(input.value);
                const isAnswerCorrect = question.answers[index].correct || false;
                
                fieldset.querySelectorAll('input').forEach(sibling =>
                    sibling.classList.add(isAnswerCorrect ? 'quiz-feedback-correct-answer' : 'quiz-feedback-wrong-answer'));
            });

            // Provide feedback on multiple choice questions
            form.querySelectorAll('fieldset.quiz-question-multiple-choice').forEach(fieldset => {
                const question = getQuestionFromElement(fieldset);

                // If there isn't at least one element selected,
                // we shouldn't provide feedback for that question
                if(!fieldset.querySelector('input:checked'))
                    return;
                
                fieldset.querySelectorAll('input').forEach(input => {
                    const index = parseInt(input.value);
                    const correctAnswer = question.answers[index].correct || false;

                    const isAnswerCorrect = input.checked === correctAnswer;
                    input.classList.add(isAnswerCorrect ? 'quiz-feedback-correct-answer' : 'quiz-feedback-wrong-answer');
                });
            });

            // Provide feedback on true or false questions
            form.querySelectorAll('fieldset.quiz-question-true-or-false').forEach(fieldset => {
                const question = getQuestionFromElement(fieldset);
                const input = fieldset.querySelector('input:checked');
                if (!input) // In case the user hasn't answered, we do not want to provide feedback
                    return;

                const option = input.value === 'true';
                const isAnswerCorrect = (option === question.correct) === input.checked;

                fieldset.querySelectorAll('input').forEach(sibling => {
                    sibling.classList.add(isAnswerCorrect ? 'quiz-feedback-correct-answer' : 'quiz-feedback-wrong-answer');
                });
            });

            // Provide feedback for short answer questions
            form.querySelectorAll('fieldset.quiz-question-short-answer').forEach(fieldset => {
                const question = getQuestionFromElement(fieldset);
                const correctAnswers =
                    typeof question.correct === 'string' ? [ question.correct] : question.correct;

                const input = fieldset.querySelector('input');
                if (!input.value)
                    return;

                const isAnswerCorrect = correctAnswers.indexOf(input.value) !== -1;
                input.classList.add(isAnswerCorrect ? 'quiz-feedback-correct-answer' : 'quiz-feedback-wrong-answer');
            });
        });
        
        const fillButton = document.querySelector('#fill');
        fillButton.addEventListener('click', event => {
            event.preventDefault();

            const form = document.querySelector('form');
            resetAnswers(form);

            // Fill single and multiple choice questions
            form.querySelectorAll('fieldset.quiz-question-single-choice, fieldset.quiz-question-multiple-choice').forEach(fieldset => {
                const question = getQuestionFromElement(fieldset);
                fieldset.querySelectorAll('input').forEach(input => {
                    const index = parseInt(input.value);
                    if (question.answers[index].correct)
                        input.checked = true;
                });
            });

            // Fill true or false questions
            form.querySelectorAll('fieldset.quiz-question-true-or-false').forEach(fieldset => {
                const question = getQuestionFromElement(fieldset);
                const input = fieldset.querySelector(`input[value="${question.correct}"]`);
                
                input.checked = true;
            });

            // Fill short answer questions
            form.querySelectorAll('fieldset.quiz-question-short-answer').forEach(fieldset => {
                const question = getQuestionFromElement(fieldset);
                const correctAnswers =
                    typeof question.correct === 'string' ? [ question.correct ] : question.correct;

                const input = fieldset.querySelector('input');
                input.value = correctAnswers[0];    
            });
        });
        
        const clearButton = document.querySelector('#clear');
        clearButton.addEventListener('click', event => {
            event.preventDefault();

            const form = document.querySelector('form');
            resetAnswers(form);
        });
    </script>
</body>
</html>
